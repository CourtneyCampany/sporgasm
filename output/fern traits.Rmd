---
title: "Tropical Fern Functional Traits"
output: html_document
---

```{r, results="asis", echo=FALSE, warning=FALSE}
library(knitr)
opts_knit$set(root.dir = '../')
```

# Background

Below is the compliation of the working data sets for the leaf realtions paper.  Eventually the paper will present findings from the following traits (traits in bold are included in this report):

* PV Curves
* Stomata: size and **density**
* Vein density
* **SLA**
* **Isotopes**
* **Morphometrics- length/width/stipe length etc.**
* Phylogeny
* **Chlorophyll**

# Statistics

I have set up a linear mixed effect model design for each trait analysis. The general model equation is:

\

**trait ~ niche2 x site + (1|species)**

\

Niche2 recodes our one climbing species as a terrestrial species. In this setup, species is used a a random effect, since individual species effects are not included in our central questions. This model returns 2 R^2^ values, one for the whole model and one for the fixed effect only. This allows us to evaluate the amount of variation atribute soley to species differences.

\

First, I check for the presence of an interaction.  Most of the time there is not one. I re-run the model with only niche2 and site as main effects, and then evaluate the models against each other (AIC scores). In most cases, I drop the interaction term and use the simpliest model. Depending on our question, the setup can change. For example, if we have no interest in site effects, I can embed species within site and treat them both as random effects. Currently, I am using a type 3 ANOVA because we have a unbalanced design (hemi-epiphytes)

# Data visualizations

Below are a series figures of analyzed traits between terrestrial, epiphytic and hemi-epiphytic tropical ferns. I have overlayed the raw data on top of boxplots for either niche or site treatments. The width or each boxplots is proportional to the square-root of the number of observations in each group. If there are significant main effects ($alpha$ level of 0.05) I have included significance letters from a post-hoc Tukey's test.

# Leaf Morphology

```{r morph,  echo=FALSE, fig.align='center',fig.width = 9, fig.height = 12}
source("master_scripts/morphology_plots.R")
```

\

```{r bivar,  echo=FALSE, fig.align='center',fig.width = 9, fig.height = 12}
source("master_scripts/frondlength_laminaarea_plot.R")
```

## Stomata

```{r sd,  echo=FALSE, fig.align='center',fig.width = 7, fig.height = 7}
source("master_scripts/stomatal_density_plot.R")
```

## Leaf Chemistry 

```{r nitro,  echo=FALSE, fig.align='center',fig.width = 7, fig.height = 7}
source("master_scripts/leaf_chemistry_plots.R")
```

\

```{r 13c,  echo=FALSE, fig.align='center',fig.width = 10, fig.height = 7}
source("master_scripts/13C_plots.R")
```

\

```{r 15n,  echo=FALSE, fig.align='center',fig.width = 7, fig.height = 7}
source("master_scripts/15N_plots.R")
```
There is an interaction between site and niche that is likely not biologically relevant; some treatments for niche are lower at Las Cruces (but not all).  

# Chlorophyll 

```{r chl,  echo=FALSE, fig.align='center',fig.width = 7, fig.height = 7}
source("master_scripts/chlorophyll_plots.R")
```
I had to perform a little data magic to make this happen.  I dropped one epiphytic species with way to variable data (400-800 units) and a few outliers.

## Hydrauliic Traits Figures

This document contains summary statistics for the 2017 La Selva field work. Below are visualizations for many of the hyrdaulic traits we derived from pressure volume curves. These traits are calculated from Sacks's excel macro. I have deleted the "climber" catergory for ease of viewing.

# ```{r op,  echo=FALSE, fig.align='center',fig.width = 7, fig.height = 7}
# par(mgp=c(2.5,1,0), mar=c(5,5,1,1), cex.lab=1.1)
# boxplot(osmotic_potential ~ niche, data=hydro_agg,xaxt='n',ylim=c(-1.25, -.5),
#         ylab=("Osmotic Potential"), outline=FALSE)
# axis(1, niche_lab_noclimb, at=1:3, cex=1.1)
# text(x=c(1,2,3,4),y=-.55, labels=niche_lab2[2:4])
# ```
# 
# 
# ```{r wp,  echo=FALSE, fig.align='center',fig.width = 7, fig.height = 7}
# par(mgp=c(2.5,1,0), mar=c(5,5,1,1), cex.lab=1.1)
# boxplot(waterpot_tlp ~ niche, data=hydro_agg,xaxt='n', ylim=c(-1.5, -.5),
#         ylab=("Water Potential @\n Turgor Loss Point"), outline=FALSE)
# axis(1, niche_lab_noclimb, at=1:3, cex=1.1)
# text(x=c(1,2,3,4),y=-.6, labels=niche_lab2[2:4])
# ```
# 
# ```{r rwc,  echo=FALSE, fig.align='center',fig.width = 7, fig.height = 7}
# par(mgp=c(2.5,1,0), mar=c(5,5,1,1), cex.lab=1.1)
# boxplot(rwc_tlp ~ niche, data=hydro_agg,xaxt='n', ylim=c(80, 105),
#         ylab=("Relative Water Content @\n Turgor Loss Point"), outline=FALSE)
# axis(1, niche_lab_noclimb, at=1:3, cex=1.1)
# text(x=c(1,2,3,4),y=102.5, labels=niche_lab2[2:4])
# ```
# 
# ```{r elas,  echo=FALSE, fig.align='center',fig.width = 7, fig.height = 7}
# par(mgp=c(2.5,1,0), mar=c(5,5,1,1), cex.lab=1.1)
# boxplot(elasticity ~ niche, data=hydro_agg,xaxt='n',ylim=c(0, 40),
#         ylab=("Modulus of Elasticity @\n Full Turgor"), outline=FALSE)
# axis(1, niche_lab_noclimb, at=1:3, cex=1.1)
# text(x=c(1,2,3,4),y=35, labels=niche_lab2[2:4])
# ```
# 
# ```{r capF,  echo=FALSE, fig.align='center',fig.width = 7, fig.height = 7}
# par(mgp=c(2.5,1,0), mar=c(5,5,1,1), cex.lab=1.1)
# boxplot(capacitance_full ~ niche, data=hydro_agg,xaxt='n',ylim=c(0,.19),
#         ylab=("Relative Capacitance @\n Full Turgor"), outline=FALSE)
# axis(1, niche_lab_noclimb, at=1:3, cex=1.1)
# text(x=c(1,2,3,4),y=.18, labels=niche_lab2[2:4])
# ```
# 
# ```{r capO,  echo=FALSE, fig.align='center',fig.width = 7, fig.height = 7}
# par(mgp=c(2.5,1,0), mar=c(5,5,1,1), cex.lab=1.1)
# boxplot(capacitance_zero. ~ niche, data=hydro_agg,xaxt='n',ylim=c(0,1),
#         ylab=("Relative Capacitance @\n Zero Turgor"), outline=FALSE)
# axis(1, niche_lab_noclimb, at=1:3, cex=1.1)
# text(x=c(1,2,3,4),y=.9, labels=niche_lab2[2:4])
# ```
# 
# ```{r capA,  echo=FALSE, fig.align='center',fig.width = 7, fig.height = 7}
# par(mgp=c(2.5,1,0), mar=c(5,5,1,1), cex.lab=1.1)
# boxplot(capacitance_absolute ~ niche, data=hydro_agg,xaxt='n', ylim=c(0,.5),
#         ylab=("Absolute Capacitance per\n Leaf Area @ Full Turgor"), outline=FALSE)
# axis(1, niche_lab_noclimb, at=1:3, cex=1.1)
# text(x=c(1,2,3,4),y=.45, labels=niche_lab2[2:4])
# ```
# 
# ```{r swc,  echo=FALSE, fig.align='center',fig.width = 7, fig.height = 7}
# par(mgp=c(2.5,1,0), mar=c(5,5,1,1), cex.lab=1.1)
# boxplot(SWC ~ niche, data=hydro_agg,xaxt='n',ylim=c(0, 8),
#         ylab=("Saturated Water Content"), outline=FALSE)
# axis(1, niche_lab_noclimb, at=1:3, cex=1.1)
# text(x=c(1,2,3,4),y=7, labels=niche_lab2[2:4])
# ```
# 

